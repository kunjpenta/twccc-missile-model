TEWA (Threat Evaluation & Weapon Assignment) — Frontend Handover Document

Prepared For: Angular Frontend Team
Prepared By: Backend Team (Django/Python)
Date: 2025-10-08

1. Project Overview

TEWA is a threat evaluation and weapon assignment system. The backend is fully implemented in Python 3.10 / Django 5.1.x with PostgreSQL. The frontend will be implemented in Angular + TypeScript, consuming backend REST APIs.

Key Functional Modules for Frontend:

Home / Scenario listing

Scenario detail pages (DA / Track / ThreatScore tables)

CSV upload for Tracks

Compute Now button to trigger threat calculation

Threat Ranking display (top-N per DA or global)

All datetime fields are UTC-aware (ISO-8601) and must be handled accordingly.

2. Backend API Contracts

All API endpoints are prefixed with /api/tewa/.

2.1 Scenario APIs

GET /scenarios/

Returns list of scenarios for dropdowns / table.

Response Example:

[
{"id":1,"name":"Demo-Scenario","start_time":"2025-09-30T11:30:00Z","end_time":null,"notes":"Seeded demo scenario"},
{"id":2,"name":"Scenario-2","start_time":"2025-09-30T11:30:00Z","end_time":null,"notes":"Seeded scenario 2"}
]

2.2 Defended Asset (DA) APIs

GET /da/

Returns list of all DAs.

Each DA has: id, name, lat, lon, radius_km.

2.3 Track / TrackSample APIs

GET /tracks/?scenario_id=<id>

Returns all tracks for a scenario.

Track fields: track_id, lat, lon, alt_m, speed_mps, heading_deg.

GET /tracksamples/?track_id=<id>

Returns all samples for a specific track.

2.4 Threat Computation APIs

POST /compute_now/

Trigger computation of ThreatScores for a scenario (all tracks and DAs).

Request body:

{
"scenario_id": 1,
"da_id": null, // optional
"weapon_range_km": 20 // optional
}

Response: JSON message + number of threats computed.

POST /compute_at/

Compute ThreatScores at a given timestamp.

Request body:

{
"scenario_id":1,
"when":"2025-09-30T06:07:30Z",
"da_ids":[1,2],
"method":"linear",
"weapon_range_km":20
}

2.5 Threat Ranking APIs

GET /ranking/?scenario_id=<id>&top_n=<N>&da_id=<id_optional>

Returns top-N threats per DA or global.

Response Example:

[
{
"da_name":"DA-Alpha (Jaisalmer)",
"threats":[
{"track_id":"T2","score":0.76,"computed_at":"2025-10-01T07:23:01Z"},
{"track_id":"T1","score":0.57,"computed_at":"2025-10-01T07:36:15Z"}
]
},
{
"da_name":"DA-Bravo (Jodhpur)",
"threats":[
{"track_id":"T3","score":0.06,"computed_at":"2025-10-01T07:23:01Z"}
]
}
]

2.6 CSV Upload API

POST /upload_tracks/

Accepts CSV file with track info (track_id, lat, lon, alt_m, speed_mps, heading_deg, timestamp).

Response includes summary:

{"message":"Upload ok","tracks_created":3,"samples_created":3,"rows_processed":3,"errors":[]}

Frontend should show progress using HttpEventType.UploadProgress.

3. Pages / Components
   3.1 Home Page (Scenario List)

URL: /

Displays all scenarios in a table:

Columns: Name, Start Time, End Time, Notes, Actions

Action: “View Details” button → scenario detail page

API Calls:

GET /api/tewa/scenarios/

3.2 Scenario Detail Page

URL: /scenario/<scenario_id>/

Sections:

Scenario Header: name, start/end, notes

Defended Assets: list all DAs

Tracks: list all tracks with basic info

Threat Scores Table: track_id, DA name, score, computed_at

Compute Now Button: triggers POST /compute_now/

Ranking Display: fetch top-N via GET /ranking/?scenario_id=<id>

API Calls:

Tracks: GET /tracks/?scenario_id=<id>

ThreatScores: GET /score/?scenario_id=<id> (optional)

Compute Now: POST /compute_now/

Rankings: GET /ranking/?scenario_id=<id>&top_n=10

3.3 Compute Now Button Behavior

Sends a POST request with scenario_id to backend.

On success, page reloads to show updated Threat Scores.

Button should be disabled while computation is in progress.

4. Data Flow Summary
   Frontend (Angular)
   |
   | GET /api/tewa/scenarios/
   | GET /api/tewa/da/
   | GET /tracks/?scenario_id=
   | GET /score/?scenario_id=
   | GET /ranking/?scenario_id=&top_n=
   |
   | POST /compute_now/
   | POST /compute_at/
   | POST /upload_tracks/
   v
   Backend (Django / REST API)
   |
   | Computes CPA/TCPA/TDB/TWRP
   | Applies normalization & scoring
   | Persists ThreatScore entries
   |
   Database (PostgreSQL) - Scenario - DefendedAsset - Track / TrackSample - ModelParams - ThreatScore

5. UI / Layout Notes

Tables: Use consistent striped styling.

Navigation: Base template base.html provides Home, About, Contact, Login.

Buttons: Compute Now triggers backend computation.

Datetime: Always use UTC (ISO-8601), display in local timezone if desired.

6. Sample Workflow for Frontend

User opens / → sees Scenario List.

Clicks “View Details” → navigates to /scenario/<id>/.

Views DAs, Tracks, Threat Scores.

Clicks Compute Now → triggers backend, page refreshes with new scores.

Optionally, fetch Rankings API to display top-N threats per DA.

Upload CSV via upload_tracks component → show progress + summary.

7. Notes for Frontend Implementation

All dynamic data comes via REST API; no server-side HTML logic is required beyond initial template rendering.

Backend already validates timestamps, DA/Track existence, and scores.

Handle empty states (no tracks, no threat scores) gracefully.

Use observable streams in Angular services for polling (optional for top-N ranking updates).

This document provides a complete frontend blueprint for Angular developers to implement all UI pages and consume backend APIs.
